<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××™××•×Ÿ ×”××•×— ×”×™×× ×™ ×•×¡×™× ×›×¨×•×Ÿ ×”×”××™×¡×¤×¨×•×ª</title>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700&family=Rubik:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --pink-light: #FFE8F0;
            --pink-medium: #FFB6C8;
            --pink-dark: #E8A0B0;
            --cream: #FFF8F0;
            --cream-dark: #F5EDE5;
            --gold: #D4A574;
            --gold-light: #E8C9A8;
            --gold-dark: #B8956A;
            --purple-soft: #DCD0FF;
            --blue-soft: #C8E0FF;
            --text-dark: #4A3F55;
            --text-light: #7A6B85;
            --white: #FFFFFF;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Heebo', sans-serif;
            background: var(--pink-light);
            min-height: 100vh;
            color: var(--text-dark);
        }

        .header {
            background: var(--pink-medium);
            padding: 25px 20px;
            text-align: center;
        }

        .header h1 {
            font-family: 'Rubik', sans-serif;
            font-size: 1.8rem;
            color: var(--white);
        }

        .header p {
            font-size: 0.95rem;
            color: var(--white);
            margin-top: 8px;
        }

        .brain-container {
            display: flex;
            justify-content: center;
            padding: 30px 20px;
        }

        .brain-visual {
            position: relative;
            width: 280px;
            height: 200px;
        }

        .hemisphere {
            position: absolute;
            width: 130px;
            height: 160px;
            border-radius: 50% 50% 45% 45%;
            top: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .hemisphere:hover { transform: scale(1.05); }
        .left-brain { left: 10px; background: var(--blue-soft); }
        .right-brain { right: 10px; background: var(--purple-soft); }

        .hemisphere-label { font-size: 0.85rem; font-weight: 600; color: var(--text-dark); }
        .hemisphere-traits { font-size: 0.7rem; color: var(--text-light); text-align: center; line-height: 1.4; }

        .synapse-container {
            position: absolute;
            left: 50%; top: 50%;
            transform: translate(-50%, -50%);
            width: 40px; height: 100px;
        }

        .synapse {
            position: absolute;
            width: 4px; height: 4px;
            background: var(--gold);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .synapse:nth-child(1) { top: 10%; left: 50%; animation-delay: 0s; }
        .synapse:nth-child(2) { top: 30%; left: 30%; animation-delay: 0.3s; }
        .synapse:nth-child(3) { top: 50%; left: 50%; animation-delay: 0.6s; }
        .synapse:nth-child(4) { top: 70%; left: 70%; animation-delay: 0.9s; }
        .synapse:nth-child(5) { top: 90%; left: 50%; animation-delay: 1.2s; }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(2.5); opacity: 1; }
        }

        .sync-status {
            text-align: center;
            padding: 15px;
            background: var(--white);
            margin: 0 20px 20px;
            border-radius: 15px;
        }

        .sync-meter { height: 12px; background: var(--cream-dark); border-radius: 10px; margin: 10px 0; }
        .sync-fill { height: 100%; background: var(--gold); border-radius: 10px; transition: width 0.5s; }
        .sync-text { font-size: 0.85rem; color: var(--text-light); }

        .reset-btn {
            margin-top: 10px;
            padding: 8px 20px;
            border: 2px solid var(--pink-medium);
            border-radius: 20px;
            background: var(--white);
            color: var(--text-dark);
            font-family: 'Heebo', sans-serif;
            cursor: pointer;
        }

        .reset-btn:hover { background: var(--pink-light); }

        .tabs {
            display: flex;
            justify-content: center;
            gap: 10px;
            padding: 0 20px 20px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            font-family: 'Heebo', sans-serif;
            font-size: 0.9rem;
            cursor: pointer;
            background: var(--white);
            color: var(--text-dark);
        }

        .tab-btn.active { background: var(--gold); color: var(--white); }

        .main-content { padding: 0 20px 100px; }
        .section { display: none; }
        .section.active { display: block; }

        .exercise-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }

        .exercise-card {
            background: var(--white);
            border-radius: 20px;
            padding: 25px;
            position: relative;
        }

        .exercise-card::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 5px; background: var(--gold); border-radius: 20px 20px 0 0; }

        .exercise-icon {
            width: 60px; height: 60px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            margin-bottom: 15px;
        }

        .icon-creative { background: var(--purple-soft); }
        .icon-visual { background: var(--pink-light); }
        .icon-sync { background: var(--gold-light); }
        .icon-movement { background: var(--blue-soft); }

        .exercise-card h3 { font-family: 'Rubik', sans-serif; font-size: 1.1rem; margin-bottom: 10px; }
        .exercise-card p { font-size: 0.85rem; color: var(--text-light); line-height: 1.6; margin-bottom: 15px; }

        .start-btn {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 12px;
            background: var(--gold);
            color: var(--white);
            font-family: 'Heebo', sans-serif;
            font-size: 0.95rem;
            cursor: pointer;
        }

        .exercise-modal {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(74, 63, 85, 0.9);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .exercise-modal.active { display: flex; }

        .modal-content {
            background: var(--white);
            border-radius: 25px;
            padding: 30px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .close-modal {
            position: absolute;
            top: 15px; left: 15px;
            width: 35px; height: 35px;
            border: none;
            border-radius: 50%;
            background: var(--cream);
            cursor: pointer;
            font-size: 1.2rem;
        }

        .modal-title { font-family: 'Rubik', sans-serif; font-size: 1.4rem; margin-bottom: 20px; text-align: center; }
        .exercise-area { min-height: 250px; display: flex; flex-direction: column; align-items: center; justify-content: center; }

        .canvas-container { background: var(--cream); border-radius: 15px; padding: 10px; margin-bottom: 15px; }
        #drawingCanvas { border-radius: 10px; background: var(--white); cursor: crosshair; touch-action: none; }
        .canvas-tools { display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; margin-top: 10px; }

        .tool-btn {
            padding: 8px 15px;
            border: 2px solid var(--pink-medium);
            border-radius: 20px;
            background: var(--white);
            font-family: 'Heebo', sans-serif;
            cursor: pointer;
        }

        .tool-btn:hover { background: var(--pink-medium); color: var(--white); }

        .timer-display { font-family: 'Rubik', sans-serif; font-size: 3rem; color: var(--gold-dark); margin: 20px 0; }
        .timer-label { font-size: 0.9rem; color: var(--text-light); margin-bottom: 10px; }
        .timer-controls { display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; }

        .timer-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            font-family: 'Heebo', sans-serif;
            cursor: pointer;
        }

        .timer-btn.primary { background: var(--gold); color: var(--white); }
        .timer-btn.secondary { background: var(--cream); color: var(--text-dark); }
        .timer-btn:disabled { opacity: 0.5; cursor: not-allowed; }

        .current-word { font-family: 'Rubik', sans-serif; font-size: 2.5rem; color: var(--gold-dark); margin: 20px 0; padding: 20px; background: var(--cream); border-radius: 15px; }

        .association-input {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--pink-light);
            border-radius: 12px;
            font-family: 'Heebo', sans-serif;
            font-size: 1rem;
            text-align: center;
        }

        .association-input:focus { outline: none; border-color: var(--gold); }
        .association-input:disabled { background: var(--cream-dark); }

        .associations-list { display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; margin-top: 15px; }
        .association-tag { padding: 8px 15px; background: var(--purple-soft); border-radius: 20px; font-size: 0.85rem; }

        .breathing-circle {
            width: 200px; height: 200px;
            border-radius: 50%;
            background: var(--blue-soft);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
            transform: scale(1);
        }

        .breathing-circle.inhale {
            animation: breatheIn 6s ease forwards;
        }
        
        .breathing-circle.exhale {
            animation: breatheOut 6s ease forwards;
        }
        
        .breathing-circle.hold {
            /* No animation - stays still */
        }

        @keyframes breatheIn {
            from { transform: scale(1); background: var(--blue-soft); }
            to { transform: scale(1.3); background: var(--purple-soft); }
        }
        
        @keyframes breatheOut {
            from { transform: scale(1.3); background: var(--purple-soft); }
            to { transform: scale(0.8); background: var(--gold-light); }
        }

        .breathing-text { font-family: 'Rubik', sans-serif; font-size: 1.3rem; color: var(--text-dark); text-align: center; }

        .nostril-indicator { display: flex; gap: 40px; justify-content: center; margin-top: 20px; }

        .nostril {
            width: 70px; height: 70px;
            border-radius: 50%;
            background: var(--cream);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            flex-direction: column;
            transition: all 0.3s;
        }

        .nostril.active { background: var(--gold); transform: scale(1.1); }
        .nostril-label { font-size: 0.7rem; margin-top: 3px; color: var(--text-light); }

        .movement-visual { display: flex; justify-content: center; gap: 50px; margin: 20px 0; }

        .body-part {
            width: 80px; height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
        }

        .left-part { background: var(--blue-soft); }
        .right-part { background: var(--purple-soft); }

        .movement-instruction { font-size: 1.2rem; color: var(--text-dark); margin-bottom: 20px; text-align: center; }

        .figure-display { display: flex; gap: 40px; justify-content: center; margin: 20px 0; }

        .figure-box {
            width: 120px; height: 120px;
            background: var(--cream);
            border-radius: 15px;
            position: relative;
            overflow: hidden;
        }

        .figure-label { position: absolute; bottom: -25px; left: 0; right: 0; text-align: center; font-size: 0.8rem; color: var(--text-light); }

        .dot-animate {
            width: 15px; height: 15px;
            background: var(--gold);
            border-radius: 50%;
            position: absolute;
        }

        .dot-8 { animation: move8 3s infinite ease-in-out; }
        .dot-0 { animation: move0 3s infinite ease-in-out; background: var(--purple-soft); border: 3px solid var(--gold-dark); }

        @keyframes move8 {
            0%, 100% { top: 50%; left: 50%; transform: translate(-50%, -50%); }
            12.5% { top: 20%; left: 70%; }
            25% { top: 50%; left: 50%; transform: translate(-50%, -50%); }
            37.5% { top: 80%; left: 70%; }
            50% { top: 50%; left: 50%; transform: translate(-50%, -50%); }
            62.5% { top: 20%; left: 30%; }
            75% { top: 50%; left: 50%; transform: translate(-50%, -50%); }
            87.5% { top: 80%; left: 30%; }
        }

        @keyframes move0 {
            0%, 100% { top: 10%; left: 50%; transform: translate(-50%, 0); }
            25% { top: 50%; left: 90%; transform: translate(-50%, -50%); }
            50% { top: 90%; left: 50%; transform: translate(-50%, -100%); }
            75% { top: 50%; left: 10%; transform: translate(-50%, -50%); }
        }

        .score-display { background: var(--gold); color: var(--white); padding: 10px 20px; border-radius: 20px; font-weight: 600; margin-bottom: 15px; }

        .listening-notes {
            width: 100%;
            min-height: 100px;
            padding: 15px;
            border: 2px solid var(--pink-medium);
            border-radius: 12px;
            font-family: 'Heebo', sans-serif;
            resize: vertical;
            margin-top: 15px;
        }

        .progress-stats { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
        .stat-card { background: var(--white); border-radius: 15px; padding: 20px; text-align: center; }
        .stat-value { font-family: 'Rubik', sans-serif; font-size: 2rem; color: var(--gold-dark); }
        .stat-label { font-size: 0.85rem; color: var(--text-light); margin-top: 5px; }

        .daily-streak { background: var(--gold); border-radius: 20px; padding: 25px; text-align: center; margin-bottom: 20px; color: var(--white); }
        .streak-number { font-family: 'Rubik', sans-serif; font-size: 3rem; }

        .tips-list { display: flex; flex-direction: column; gap: 15px; }
        .tip-card { background: var(--white); border-radius: 15px; padding: 20px; display: flex; gap: 15px; }
        .tip-icon { width: 45px; height: 45px; border-radius: 12px; background: var(--gold-light); display: flex; align-items: center; justify-content: center; font-size: 1.3rem; flex-shrink: 0; }
        .tip-content h4 { font-size: 1rem; margin-bottom: 5px; }
        .tip-content p { font-size: 0.85rem; color: var(--text-light); }

        .eye-tracking-area { position: relative; width: 100%; height: 200px; background: var(--cream); border-radius: 15px; }
        .tracking-ball { position: absolute; width: 30px; height: 30px; border-radius: 50%; background: var(--gold); transition: all 1.5s ease-in-out; }
    </style>
</head>
<body>
    <header class="header">
        <h1>ğŸ§  ××™××•×Ÿ ×”××•×— ×”×™×× ×™</h1>
        <p>×©×—×¨×¨ ××ª ×”×™×¦×™×¨×ª×™×•×ª ×•×¡× ×›×¨×Ÿ ××ª ×”×”××™×¡×¤×¨×•×ª</p>
    </header>

    <div class="brain-container">
        <div class="brain-visual">
            <div class="hemisphere left-brain">
                <span class="hemisphere-label">ğŸ”¢ ×©×××œ</span>
                <span class="hemisphere-traits">×œ×•×’×™×§×” â€¢ ×©×¤×”<br>××ª××˜×™×§×”</span>
            </div>
            <div class="synapse-container" id="synapseContainer">
                <div class="synapse"></div>
                <div class="synapse"></div>
                <div class="synapse"></div>
                <div class="synapse"></div>
                <div class="synapse"></div>
            </div>
            <div class="hemisphere right-brain">
                <span class="hemisphere-label">ğŸ¨ ×™××™×Ÿ</span>
                <span class="hemisphere-traits">×™×¦×™×¨×ª×™×•×ª â€¢ ×“××™×•×Ÿ<br>××™× ×˜×•××™×¦×™×”</span>
            </div>
        </div>
    </div>

    <div class="sync-status">
        <div class="sync-text">×¨××ª ×¡×™× ×›×¨×•×Ÿ ×”×”××™×¡×¤×¨×•×ª</div>
        <div class="sync-meter">
            <div class="sync-fill" id="syncFill" style="width: 0%"></div>
        </div>
        <div class="sync-text"><span id="syncPercent">0</span>% ××¡×•× ×›×¨×Ÿ</div>
        <button class="reset-btn" onclick="resetProgress()">ğŸ”„ ×”×ª×—×œ×” ××—×“×©</button>
    </div>

    <div class="tabs">
        <button class="tab-btn active" onclick="showSection('right-brain', this)">ğŸ¨ ××•×— ×™×× ×™</button>
        <button class="tab-btn" onclick="showSection('sync', this)">ğŸ”„ ×¡×™× ×›×¨×•×Ÿ</button>
        <button class="tab-btn" onclick="showSection('progress', this)">ğŸ“Š ×”×ª×§×“××•×ª</button>
        <button class="tab-btn" onclick="showSection('tips', this)">ğŸ’¡ ×˜×™×¤×™×</button>
    </div>

    <main class="main-content">
        <section id="right-brain" class="section active">
            <div class="exercise-grid">
                <div class="exercise-card">
                    <div class="exercise-icon icon-creative">âœï¸</div>
                    <h3>×¦×™×•×¨ ×‘×™×“ ×œ× ×“×•××™× × ×˜×™×ª</h3>
                    <p>×¦×™×™×¨ ×¢× ×”×™×“ ×”×œ× ×“×•××™× × ×˜×™×ª. ××¤×¢×™×œ ××ª ×”×”××™×¡×¤×¨×” ×”× ×’×“×™×ª.</p>
                    <button class="start-btn" onclick="openExercise('drawing')">×”×ª×—×œ</button>
                </div>

                <div class="exercise-card">
                    <div class="exercise-icon icon-visual">ğŸ”®</div>
                    <h3>×–×™×”×•×™ ×“×¤×•×¡×™×</h3>
                    <p>××¦× ××ª ×”×“×¤×•×¡ ×”×—×¡×¨. ××¤×ª×— ×—×©×™×‘×” ×•×™×–×•××œ×™×ª.</p>
                    <button class="start-btn" onclick="openExercise('pattern')">×”×ª×—×œ</button>
                </div>

                <div class="exercise-card">
                    <div class="exercise-icon icon-creative">ğŸ’­</div>
                    <h3>××¡×•×¦×™××¦×™×•×ª ×—×•×¤×©×™×•×ª</h3>
                    <p>×›×ª×•×‘ ××¡×•×¦×™××¦×™×•×ª ×œ××™×œ×” ×ª×•×š ×“×§×”. ××©×—×¨×¨ ×™×¦×™×¨×ª×™×•×ª.</p>
                    <button class="start-btn" onclick="openExercise('association')">×”×ª×—×œ</button>
                </div>

                <div class="exercise-card">
                    <div class="exercise-icon icon-visual">ğŸµ</div>
                    <h3>×”×§×©×‘×” ××•×“×¢×ª</h3>
                    <p>×”×§×©×‘ ×œ×¡×‘×™×‘×” ×•×¨×©×•× ××ª ×”×¦×œ×™×œ×™× ×©×©××¢×ª.</p>
                    <button class="start-btn" onclick="openExercise('listening')">×”×ª×—×œ</button>
                </div>

                <div class="exercise-card">
                    <div class="exercise-icon icon-creative">ğŸ­</div>
                    <h3>×“××™×•×Ÿ ××•×“×¨×š</h3>
                    <p>×¡×’×•×¨ ×¢×™× ×™×™× ×•×“××™×™×Ÿ ×¡×¦× ×” ×‘×¤×™×¨×•×˜.</p>
                    <button class="start-btn" onclick="openExercise('imagination')">×”×ª×—×œ</button>
                </div>

                <div class="exercise-card">
                    <div class="exercise-icon icon-visual">ğŸ¨</div>
                    <h3>×–×™×”×•×™ ×’×•×•× ×™× ×¢×“×™× ×™×</h3>
                    <p>××¦× ××ª ×”×’×•×•×Ÿ ×”×©×•× ×” - 5 ×¡×™×‘×•×‘×™×.</p>
                    <button class="start-btn" onclick="openExercise('colors')">×”×ª×—×œ</button>
                </div>
            </div>
        </section>

        <section id="sync" class="section">
            <div class="exercise-grid">
                <div class="exercise-card">
                    <div class="exercise-icon icon-movement">ğŸ¤¸</div>
                    <h3>×ª× ×•×¢×•×ª ×§×¨×•×¡×œ×˜×¨×œ×™×•×ª</h3>
                    <p>×™×“ ×™××™×Ÿ ×œ×‘×¨×š ×©×××œ ×•×œ×”×™×¤×š. ××¦×•×™×Ÿ ×œ×¡×™× ×›×¨×•×Ÿ!</p>
                    <button class="start-btn" onclick="openExercise('crosslateral')">×”×ª×—×œ</button>
                </div>

                <div class="exercise-card">
                    <div class="exercise-icon icon-sync">ğŸ‘ï¸</div>
                    <h3>××¢×§×‘ ×¢×™× ×™×™×</h3>
                    <p>×¢×§×•×‘ ××—×¨×™ ×”× ×§×•×“×” ×”× ×¢×” ×‘×¢×™× ×™×™× ×‘×œ×‘×“.</p>
                    <button class="start-btn" onclick="openExercise('eyetracking')">×”×ª×—×œ</button>
                </div>

                <div class="exercise-card">
                    <div class="exercise-icon icon-sync">ğŸŒ¬ï¸</div>
                    <h3>× ×©×™××ª × ×—×™×¨×™×™× ×œ×¡×™×¨×•×’×™×Ÿ</h3>
                    <p>×˜×›× ×™×§×” ×¢×ª×™×§×” - 6 ×©× ×™×•×ª ×œ×›×œ ×©×œ×‘.</p>
                    <button class="start-btn" onclick="openExercise('breathing')">×”×ª×—×œ</button>
                </div>

                <div class="exercise-card">
                    <div class="exercise-icon icon-movement">ğŸª</div>
                    <h3>×ª× ×•×¢×•×ª ××¨××”</h3>
                    <p>×ª× ×•×¢×•×ª ×–×”×•×ª ×‘×©×ª×™ ×”×™×“×™×™× ×‘×•-×–×× ×™×ª.</p>
                    <button class="start-btn" onclick="openExercise('mirror')">×”×ª×—×œ</button>
                </div>

                <div class="exercise-card">
                    <div class="exercise-icon icon-sync">âœï¸</div>
                    <h3>×›×ª×™×‘×” ×“×•-×™×“× ×™×ª</h3>
                    <p>×›×ª×•×‘ ×¢× ×©×ª×™ ×”×™×“×™×™× ×‘×•-×–×× ×™×ª.</p>
                    <button class="start-btn" onclick="openExercise('dualwriting')">×”×ª×—×œ</button>
                </div>

                <div class="exercise-card">
                    <div class="exercise-icon icon-movement">âˆ</div>
                    <h3>×¦×™×•×¨ 8 ×•-0 ×‘××•×•×™×¨</h3>
                    <p>8 ×‘×™×“ ×™××™×Ÿ, 0 ×‘×™×“ ×©×××œ - ×‘×•-×–×× ×™×ª!</p>
                    <button class="start-btn" onclick="openExercise('figure8')">×”×ª×—×œ</button>
                </div>

                <div class="exercise-card">
                    <div class="exercise-icon icon-movement">ğŸ§˜</div>
                    <h3>×ª× ×•×—×•×ª ×™×•×’×” ×××–× ×•×ª</h3>
                    <p>×¢××™×“×” ×¢×œ ×¨×’×œ ××—×ª ××¤×¢×™×œ×” ×©× ×™ ×¦×“×“×™ ×”××•×—.</p>
                    <button class="start-btn" onclick="openExercise('yoga')">×”×ª×—×œ</button>
                </div>

                <div class="exercise-card">
                    <div class="exercise-icon icon-sync">ğŸ”¢</div>
                    <h3>×¡×¤×™×¨×” ×•×"×‘ ×‘×•-×–×× ×™×ª</h3>
                    <p>×¡×¤×•×¨ ×‘×§×•×œ ×¨× ×•×›×ª×•×‘ ××ª ×”×"×‘ ×‘×•-×–×× ×™×ª.</p>
                    <button class="start-btn" onclick="openExercise('counting')">×”×ª×—×œ</button>
                </div>
            </div>
        </section>

        <section id="progress" class="section">
            <div class="daily-streak">
                <div class="streak-number" id="streakCount">0</div>
                <div>×™××™× ×¨×¦×•×¤×™× ğŸ”¥</div>
            </div>
            <div class="progress-stats">
                <div class="stat-card"><div class="stat-value" id="totalExercises">0</div><div class="stat-label">×ª×¨×’×™×œ×™×</div></div>
                <div class="stat-card"><div class="stat-value" id="totalMinutes">0</div><div class="stat-label">×“×§×•×ª</div></div>
                <div class="stat-card"><div class="stat-value" id="rightBrainScore">0</div><div class="stat-label">××•×— ×™×× ×™</div></div>
                <div class="stat-card"><div class="stat-value" id="syncScore">0</div><div class="stat-label">×¡×™× ×›×¨×•×Ÿ</div></div>
            </div>
        </section>

        <section id="tips" class="section">
            <div class="tips-list">
                <div class="tip-card"><div class="tip-icon">ğŸ¨</div><div class="tip-content"><h4>×¦×™×™×¨ ××“×™ ×™×•×</h4><p>5 ×“×§×•×ª ×¦×™×•×¨ ×—×•×¤×©×™ ×‘×™×•×.</p></div></div>
                <div class="tip-card"><div class="tip-icon">ğŸµ</div><div class="tip-content"><h4>××•×–×™×§×” ×§×œ××¡×™×ª</h4><p>××¤×¢×™×œ×” ××ª ×”××•×— ×”×™×× ×™.</p></div></div>
                <div class="tip-card"><div class="tip-icon">ğŸ¤²</div><div class="tip-content"><h4>×™×“ ×œ× ×“×•××™× × ×˜×™×ª</h4><p>×¦×—×¦×— ×©×™× ×™×™× ×‘×™×“ ×”×©× ×™×™×”.</p></div></div>
                <div class="tip-card"><div class="tip-icon">ğŸ§˜</div><div class="tip-content"><h4>××“×™×˜×¦×™×”</h4><p>××—×–×§×ª ××ª ×”×§×©×¨ ×‘×™×Ÿ ×”×”××™×¡×¤×¨×•×ª.</p></div></div>
                <div class="tip-card"><div class="tip-icon">ğŸš¶</div><div class="tip-content"><h4>×”×œ×™×›×” ×‘×˜×‘×¢</h4><p>××©×¤×¨×ª ×–×¨×™××ª ×“× ×œ××•×—.</p></div></div>
            </div>
        </section>
    </main>

    <div class="exercise-modal" id="exerciseModal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeExercise()">âœ•</button>
            <h2 class="modal-title" id="modalTitle">×ª×¨×’×™×œ</h2>
            <div class="exercise-area" id="exerciseArea"></div>
        </div>
    </div>

    <script>
        // State
        let state = { syncLevel: 0, streak: 0, totalExercises: 0, totalMinutes: 0, rightBrainScore: 0, syncScore: 0, lastActivity: null };
        
        // All active timers/intervals
        let activeTimers = [];
        
        // Exercise-specific variables
        let patternScore = 0, usedPatterns = [];
        let associations = [], assocTime = 60, assocRunning = false;
        let colorScore = 0, colorRound = 0;
        let breathRunning = false, breathPhase = 0, breathCycles = 0;
        let mirrorRunning = false, mirrorStep = 0;
        let yogaIndex = 0;

        // Load/Save state
        function loadState() {
            const saved = localStorage.getItem('brainTrainingState');
            if (saved) {
                state = JSON.parse(saved);
            }
            updateUI();
        }

        function saveState() {
            localStorage.setItem('brainTrainingState', JSON.stringify(state));
        }

        function resetProgress() {
            // Clear localStorage
            try {
                localStorage.removeItem('brainTrainingState');
                localStorage.clear();
            } catch(e) {}
            
            // Reset state object completely
            state = { 
                syncLevel: 0, 
                streak: 0, 
                totalExercises: 0, 
                totalMinutes: 0, 
                rightBrainScore: 0, 
                syncScore: 0, 
                lastActivity: null 
            };
            
            // Force update UI directly
            var syncFill = document.getElementById('syncFill');
            var syncPercent = document.getElementById('syncPercent');
            var streakCount = document.getElementById('streakCount');
            var totalExercises = document.getElementById('totalExercises');
            var totalMinutes = document.getElementById('totalMinutes');
            var rightBrainScore = document.getElementById('rightBrainScore');
            var syncScore = document.getElementById('syncScore');
            
            if (syncFill) syncFill.style.width = '0%';
            if (syncPercent) syncPercent.innerText = '0';
            if (streakCount) streakCount.innerText = '0';
            if (totalExercises) totalExercises.innerText = '0';
            if (totalMinutes) totalMinutes.innerText = '0';
            if (rightBrainScore) rightBrainScore.innerText = '0';
            if (syncScore) syncScore.innerText = '0';
            
            alert('××•×¤×¡! âœ¨');
        }

        function updateUI() {
            // Update sync meter
            const syncFill = document.getElementById('syncFill');
            const syncPercent = document.getElementById('syncPercent');
            if (syncFill) syncFill.style.width = state.syncLevel + '%';
            if (syncPercent) syncPercent.textContent = state.syncLevel;
            
            // Update progress stats
            const streakEl = document.getElementById('streakCount');
            const exercisesEl = document.getElementById('totalExercises');
            const minutesEl = document.getElementById('totalMinutes');
            const rightBrainEl = document.getElementById('rightBrainScore');
            const syncScoreEl = document.getElementById('syncScore');
            
            if (streakEl) streakEl.textContent = state.streak;
            if (exercisesEl) exercisesEl.textContent = state.totalExercises;
            if (minutesEl) minutesEl.textContent = state.totalMinutes;
            if (rightBrainEl) rightBrainEl.textContent = state.rightBrainScore;
            if (syncScoreEl) syncScoreEl.textContent = state.syncScore;
        }

        function showSection(id, btn) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            btn.classList.add('active');
        }

        function clearAllTimers() {
            activeTimers.forEach(t => {
                clearInterval(t);
                clearTimeout(t);
            });
            activeTimers = [];
            breathRunning = false;
            mirrorRunning = false;
            assocRunning = false;
        }

        function openExercise(type) {
            clearAllTimers();
            document.getElementById('exerciseModal').classList.add('active');
            const title = document.getElementById('modalTitle');
            const area = document.getElementById('exerciseArea');

            switch(type) {
                case 'drawing': setupDrawing(title, area); break;
                case 'pattern': setupPattern(title, area); break;
                case 'association': setupAssociation(title, area); break;
                case 'listening': setupListening(title, area); break;
                case 'imagination': setupImagination(title, area); break;
                case 'colors': setupColors(title, area); break;
                case 'crosslateral': setupCrosslateral(title, area); break;
                case 'eyetracking': setupEyeTracking(title, area); break;
                case 'breathing': setupBreathing(title, area); break;
                case 'mirror': setupMirror(title, area); break;
                case 'dualwriting': setupDualWriting(title, area); break;
                case 'figure8': setupFigure8(title, area); break;
                case 'yoga': setupYoga(title, area); break;
                case 'counting': setupCounting(title, area); break;
            }
        }

        function closeExercise() {
            clearAllTimers();
            document.getElementById('exerciseModal').classList.remove('active');
        }

        function completeExercise(type, points) {
            state.totalExercises++;
            state.totalMinutes += Math.round(points / 2);
            if (type === 'rightBrain') {
                state.rightBrainScore += points;
                state.syncLevel = Math.min(100, state.syncLevel + Math.round(points / 2));
            } else {
                state.syncScore += points;
                state.syncLevel = Math.min(100, state.syncLevel + points);
            }
            const today = new Date().toDateString();
            if (state.lastActivity !== today) {
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);
                state.streak = state.lastActivity === yesterday.toDateString() ? state.streak + 1 : 1;
                state.lastActivity = today;
            }
            saveState();
            updateUI();
        }

        // ===== DRAWING =====
        function setupDrawing(title, area) {
            title.textContent = 'âœï¸ ×¦×™×•×¨ ×‘×™×“ ×œ× ×“×•××™× × ×˜×™×ª';
            area.innerHTML = `
                <p style="text-align:center;margin-bottom:15px;color:var(--text-light)">×¦×™×™×¨ ×¢× ×”×™×“ ×”×œ× ×“×•××™× × ×˜×™×ª!</p>
                <div class="canvas-container"><canvas id="drawingCanvas" width="280" height="200"></canvas></div>
                <div class="canvas-tools">
                    <button class="tool-btn" onclick="setCanvasColor('#E8A0B0')">ğŸŒ¸</button>
                    <button class="tool-btn" onclick="setCanvasColor('#D4A574')">âœ¨</button>
                    <button class="tool-btn" onclick="setCanvasColor('#DCD0FF')">ğŸ’œ</button>
                    <button class="tool-btn" onclick="setCanvasColor('#4A3F55')">âš«</button>
                    <button class="tool-btn" onclick="clearCanvas()">ğŸ—‘ï¸</button>
                </div>
                <button class="tool-btn" style="margin-top:10px;width:100%" onclick="openWorksheet('drawing')">ğŸ“„ ×”×•×¨×“ ×“×£ ×¢×‘×•×“×”</button>
                <button class="start-btn" style="margin-top:10px" onclick="completeExercise('rightBrain',3);closeExercise()">×¡×™×™××ª×™ âœ“</button>
            `;
            initCanvas();
        }

        let drawing = false, canvasColor = '#E8A0B0';
        function initCanvas() {
            const c = document.getElementById('drawingCanvas');
            if (!c) return;
            const ctx = c.getContext('2d');
            ctx.strokeStyle = canvasColor;
            ctx.lineWidth = 3;
            ctx.lineCap = 'round';
            ctx.fillStyle = '#FFF';
            ctx.fillRect(0, 0, c.width, c.height);
            
            c.onmousedown = e => { drawing = true; ctx.beginPath(); ctx.moveTo(e.offsetX, e.offsetY); };
            c.onmousemove = e => { if (drawing) { ctx.lineTo(e.offsetX, e.offsetY); ctx.stroke(); } };
            c.onmouseup = c.onmouseleave = () => drawing = false;
            c.ontouchstart = e => { e.preventDefault(); drawing = true; const r = c.getBoundingClientRect(); ctx.beginPath(); ctx.moveTo(e.touches[0].clientX - r.left, e.touches[0].clientY - r.top); };
            c.ontouchmove = e => { e.preventDefault(); if (!drawing) return; const r = c.getBoundingClientRect(); ctx.lineTo(e.touches[0].clientX - r.left, e.touches[0].clientY - r.top); ctx.stroke(); };
            c.ontouchend = () => drawing = false;
        }
        function setCanvasColor(c) { canvasColor = c; const cv = document.getElementById('drawingCanvas'); if (cv) cv.getContext('2d').strokeStyle = c; }
        function clearCanvas() { const c = document.getElementById('drawingCanvas'); if (c) { const ctx = c.getContext('2d'); ctx.fillStyle = '#FFF'; ctx.fillRect(0, 0, c.width, c.height); } }

        // ===== PATTERN =====
        const patterns = [
            { seq: ['ğŸ”´','ğŸ”µ','ğŸ”´','ğŸ”µ','ğŸ”´','?'], ans: 'ğŸ”µ', opts: ['ğŸ”´','ğŸ”µ','ğŸŸ¢'] },
            { seq: ['â­','â­','ğŸŒ™','â­','â­','?'], ans: 'ğŸŒ™', opts: ['â­','ğŸŒ™','â˜€ï¸'] },
            { seq: ['ğŸŒ¸','ğŸŒº','ğŸŒ¸','ğŸŒº','ğŸŒ¸','?'], ans: 'ğŸŒº', opts: ['ğŸŒº','ğŸŒ¸','ğŸŒ·'] },
            { seq: ['ğŸ”º','ğŸ”»','ğŸ”º','ğŸ”»','ğŸ”º','?'], ans: 'ğŸ”»', opts: ['ğŸ”º','ğŸ”»','â¬›'] },
            { seq: ['ğŸ’™','ğŸ’š','ğŸ’™','ğŸ’š','ğŸ’™','?'], ans: 'ğŸ’š', opts: ['ğŸ’™','ğŸ’š','ğŸ’œ'] },
            { seq: ['ğŸ±','ğŸ¶','ğŸ±','ğŸ¶','ğŸ±','?'], ans: 'ğŸ¶', opts: ['ğŸ±','ğŸ¶','ğŸ°'] },
            { seq: ['ğŸµ','ğŸ¶','ğŸµ','ğŸ¶','ğŸµ','?'], ans: 'ğŸ¶', opts: ['ğŸµ','ğŸ¶','ğŸ¼'] }
        ];

        function setupPattern(title, area) {
            title.textContent = 'ğŸ”® ×–×™×”×•×™ ×“×¤×•×¡×™×';
            patternScore = 0;
            usedPatterns = [];
            showPattern(area);
        }

        function showPattern(area) {
            const available = patterns.filter((_, i) => !usedPatterns.includes(i));
            if (!available.length) usedPatterns = [];
            const p = available.length ? available[Math.floor(Math.random() * available.length)] : patterns[0];
            usedPatterns.push(patterns.indexOf(p));
            
            area.innerHTML = `
                <div class="score-display">× ×™×§×•×“: ${patternScore} / 5</div>
                <p style="text-align:center;margin-bottom:15px;color:var(--text-light)">××”×• ×”×¡××œ ×”×—×¡×¨?</p>
                <div style="display:flex;gap:8px;justify-content:center;margin-bottom:20px;flex-wrap:wrap">
                    ${p.seq.map(s => `<span style="font-size:1.8rem;padding:8px;background:var(--cream);border-radius:10px">${s}</span>`).join('')}
                </div>
                <div style="display:flex;gap:15px;justify-content:center">
                    ${p.opts.map(o => `<button class="tool-btn" style="font-size:1.5rem;padding:15px 25px" onclick="checkPattern('${o}','${p.ans}')">${o}</button>`).join('')}
                </div>
            `;
        }

        function checkPattern(selected, answer) {
            if (selected === answer) {
                patternScore++;
                if (patternScore >= 5) {
                    completeExercise('rightBrain', 5);
                    alert('××¦×•×™×Ÿ! ğŸ‰');
                    closeExercise();
                } else {
                    showPattern(document.getElementById('exerciseArea'));
                }
            } else {
                alert('× ×¡×” ×©×•×‘! ğŸ’ª');
            }
        }

        // ===== ASSOCIATION =====
        function setupAssociation(title, area) {
            title.textContent = 'ğŸ’­ ××¡×•×¦×™××¦×™×•×ª ×—×•×¤×©×™×•×ª';
            const words = ['×©××©','××™×','××”×‘×”','×¢×¥','×—×œ×•×','×“×¨×š','×›×•×›×‘','×™×','×©××—×”','×‘×™×ª'];
            const word = words[Math.floor(Math.random() * words.length)];
            associations = [];
            assocTime = 60;
            assocRunning = false;
            
            area.innerHTML = `
                <p style="color:var(--text-light);text-align:center">×›×ª×•×‘ ××¡×•×¦×™××¦×™×•×ª ×œ××™×œ×”:</p>
                <div class="current-word">${word}</div>
                <div class="timer-display" id="assocTimer">01:00</div>
                <div class="timer-controls" style="margin-bottom:15px">
                    <button class="timer-btn primary" id="assocStartBtn" onclick="startAssociation()">×”×ª×—×œ</button>
                    <button class="timer-btn secondary" onclick="finishAssociation()">×¡×™×•×</button>
                </div>
                <button class="tool-btn" style="margin-top:10px;width:100%" onclick="openWorksheet('association')">ğŸ“„ ×”×•×¨×“ ×“×£ ×¢×‘×•×“×”</button>
                <input type="text" class="association-input" id="assocInput" placeholder="×”×§×œ×“ ××™×œ×” ×•×œ×—×¥ Enter" onkeypress="addAssociation(event)" disabled>
                <div class="associations-list" id="assocList"></div>
            `;
        }

        function startAssociation() {
            if (assocRunning) return;
            assocRunning = true;
            const input = document.getElementById('assocInput');
            const btn = document.getElementById('assocStartBtn');
            if (input) { input.disabled = false; input.focus(); }
            if (btn) { btn.textContent = '×¨×¥...'; btn.disabled = true; }
            
            const timer = setInterval(() => {
                if (!assocRunning) { clearInterval(timer); return; }
                assocTime--;
                const el = document.getElementById('assocTimer');
                if (el) el.textContent = `${String(Math.floor(assocTime/60)).padStart(2,'0')}:${String(assocTime%60).padStart(2,'0')}`;
                if (assocTime <= 0) finishAssociation();
            }, 1000);
            activeTimers.push(timer);
        }

        function addAssociation(e) {
            if (e.key === 'Enter') {
                const input = document.getElementById('assocInput');
                const val = input.value.trim();
                if (val && !associations.includes(val)) {
                    associations.push(val);
                    const list = document.getElementById('assocList');
                    if (list) list.innerHTML += `<span class="association-tag">${val}</span>`;
                }
                input.value = '';
            }
        }

        function finishAssociation() {
            assocRunning = false;
            completeExercise('rightBrain', Math.max(Math.min(associations.length, 10), 1));
            alert(`××¦××ª ${associations.length} ××¡×•×¦×™××¦×™×•×ª! ğŸ‰`);
            closeExercise();
        }

        // ===== LISTENING =====
        function setupListening(title, area) {
            title.textContent = 'ğŸµ ×”×§×©×‘×” ××•×“×¢×ª';
            area.innerHTML = `
                <p style="text-align:center;margin-bottom:20px;color:var(--text-light)">×¢×¦×•× ×¢×™× ×™×™× ×•×”×§×©×‘ ×œ×¡×‘×™×‘×” 2 ×“×§×•×ª.</p>
                <div class="timer-display" id="listenTimer">02:00</div>
                <div class="timer-controls">
                    <button class="timer-btn primary" id="listenStartBtn" onclick="startListening()">×”×ª×—×œ</button>
                    <button class="timer-btn secondary" onclick="stopListening()">×¢×¦×•×¨</button>
                </div>
                <button class="tool-btn" style="margin-top:10px;width:100%" onclick="openWorksheet('listening')">ğŸ“„ ×”×•×¨×“ ×“×£ ×¢×‘×•×“×”</button>
                <textarea class="listening-notes" id="listenNotes" placeholder="×›×ª×•×‘ ××ª ×”×¦×œ×™×œ×™× ×©×©××¢×ª..."></textarea>
                <button class="start-btn" style="margin-top:15px" onclick="finishListening()">×©××•×¨ ×•×¡×™×™××™ âœ“</button>
            `;
        }

        let listenTime = 120;
        function startListening() {
            listenTime = 120;
            const btn = document.getElementById('listenStartBtn');
            if (btn) { btn.disabled = true; btn.textContent = '×¨×¥...'; }
            const timer = setInterval(() => {
                listenTime--;
                const el = document.getElementById('listenTimer');
                if (el) el.textContent = `${String(Math.floor(listenTime/60)).padStart(2,'0')}:${String(listenTime%60).padStart(2,'0')}`;
                if (listenTime <= 0) { clearInterval(timer); }
            }, 1000);
            activeTimers.push(timer);
        }

        function stopListening() {
            clearAllTimers();
            const btn = document.getElementById('listenStartBtn');
            if (btn) { btn.disabled = false; btn.textContent = '×”×ª×—×œ'; }
        }

        function finishListening() {
            const notes = document.getElementById('listenNotes');
            const count = notes && notes.value.trim() ? notes.value.split('\n').filter(l => l.trim()).length : 0;
            completeExercise('rightBrain', Math.min(count + 2, 8));
            if (count > 0) alert(`×¨×©××ª ${count} ×¦×œ×™×œ×™×! ğŸµ`);
            closeExercise();
        }

        // ===== IMAGINATION =====
        const scenes = ['×“××™×™×Ÿ ×—×•×£ ×™× ×©×§×˜ ×‘×©×§×™×¢×”...','×“××™×™×Ÿ ×™×¢×¨ ×™×¨×•×§ ×¢× × ×—×œ...','×“××™×™×Ÿ ×’×Ÿ ×¤×¨×—×™× ×‘××‘×™×‘...','×“××™×™×Ÿ ×©××™×™× ××œ××™ ×›×•×›×‘×™×...','×“××™×™×Ÿ ×”×¨ ××•×©×œ×’...'];
        let sceneIndex = 0;

        function setupImagination(title, area) {
            title.textContent = 'ğŸ­ ×“××™×•×Ÿ ××•×“×¨×š';
            area.innerHTML = `
                <p style="text-align:center;margin-bottom:20px;color:var(--text-light)">×¡×’×•×¨ ×¢×™× ×™×™× ×•×“××™×™×Ÿ ××ª ×”×¡×¦× ×”.</p>
                <div class="current-word" id="sceneText">${scenes[0]}</div>
                <div class="timer-display" id="imgTimer">60</div>
                <div class="timer-controls">
                    <button class="timer-btn primary" onclick="startImagination()">×”×ª×—×œ</button>
                    <button class="timer-btn secondary" onclick="nextScene()">×¡×¦× ×” ×”×‘××”</button>
                </div>
                <button class="tool-btn" style="margin-top:10px;width:100%" onclick="openWorksheet('imagination')">ğŸ“„ ×”×•×¨×“ ×“×£ ×¢×‘×•×“×”</button>
                <textarea class="listening-notes" placeholder="×ª××¨ ××” ×¨××™×ª ×‘×“××™×•×Ÿ..."></textarea>
                <button class="start-btn" style="margin-top:15px" onclick="completeExercise('rightBrain',4);closeExercise()">×¡×™×™××ª×™ âœ“</button>
            `;
        }

        function startImagination() {
            let time = 60;
            const timer = setInterval(() => {
                time--;
                const el = document.getElementById('imgTimer');
                if (el) el.textContent = time;
                if (time <= 0) clearInterval(timer);
            }, 1000);
            activeTimers.push(timer);
        }

        function nextScene() {
            sceneIndex = (sceneIndex + 1) % scenes.length;
            const el = document.getElementById('sceneText');
            if (el) el.textContent = scenes[sceneIndex];
        }

        // ===== COLORS =====
        function setupColors(title, area) {
            title.textContent = 'ğŸ¨ ×–×™×”×•×™ ×’×•×•× ×™×';
            colorScore = 0;
            colorRound = 0;
            showColorRound(area);
        }

        function showColorRound(area) {
            const colors = [
                { base: '#FFB6C8', diff: '#FFC8D8' },
                { base: '#C8E0FF', diff: '#D8ECFF' },
                { base: '#DCD0FF', diff: '#E8DCFF' },
                { base: '#D4A574', diff: '#E0B484' },
                { base: '#C8E8C8', diff: '#D8F0D8' }
            ];
            const c = colors[Math.floor(Math.random() * colors.length)];
            const diffIdx = Math.floor(Math.random() * 4);
            
            area.innerHTML = `
                <div class="score-display">×¡×™×‘×•×‘ ${colorRound + 1}/5 | × ×›×•×Ÿ: ${colorScore}</div>
                <p style="text-align:center;margin-bottom:20px;color:var(--text-light)">××¦× ××ª ×”×¨×™×‘×•×¢ ×”×©×•× ×”:</p>
                <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:15px;max-width:230px;margin:0 auto">
                    ${[0,1,2,3].map(i => `<div onclick="checkColor(${i},${diffIdx})" style="width:100px;height:100px;background:${i===diffIdx?c.diff:c.base};border-radius:15px;cursor:pointer"></div>`).join('')}
                </div>
            `;
        }

        function checkColor(selected, correct) {
            colorRound++;
            if (selected === correct) colorScore++;
            if (colorRound >= 5) {
                completeExercise('rightBrain', colorScore + 1);
                alert(`${colorScore}/5 × ×›×•×Ÿ! ğŸ‘ï¸`);
                closeExercise();
            } else {
                showColorRound(document.getElementById('exerciseArea'));
            }
        }

        // ===== CROSSLATERAL =====
        const crossMoves = [
            { text: '×™×“ ×™××™×Ÿ ×œ×‘×¨×š ×©×××œ', left: 'ğŸ¦µ', right: 'ğŸ–ï¸' },
            { text: '×™×“ ×©×××œ ×œ×‘×¨×š ×™××™×Ÿ', left: 'ğŸ–ï¸', right: 'ğŸ¦µ' },
            { text: '××¨×¤×§ ×™×× ×™ ×œ×‘×¨×š ×©×××œ×™×ª', left: 'ğŸ¦µ', right: 'ğŸ’ª' },
            { text: '××¨×¤×§ ×©×××œ×™ ×œ×‘×¨×š ×™×× ×™×ª', left: 'ğŸ’ª', right: 'ğŸ¦µ' }
        ];

        function setupCrosslateral(title, area) {
            title.textContent = 'ğŸ¤¸ ×ª× ×•×¢×•×ª ×§×¨×•×¡×œ×˜×¨×œ×™×•×ª';
            area.innerHTML = `
                <p style="text-align:center;margin-bottom:15px;color:var(--text-light)">×‘×¦×¢ ×œ×¤×™ ×”×”×•×¨××•×ª:</p>
                <div class="movement-visual">
                    <div class="body-part left-part" id="crossLeft">ğŸ–ï¸</div>
                    <div class="body-part right-part" id="crossRight">ğŸ¦µ</div>
                </div>
                <div class="movement-instruction" id="crossInst">×œ×—×¥ ×”×ª×—×œ</div>
                <div class="timer-display" id="crossTimer">30</div>
                <div class="timer-controls">
                    <button class="timer-btn primary" onclick="startCrosslateral()">×”×ª×—×œ</button>
                    <button class="timer-btn secondary" onclick="clearAllTimers()">×¢×¦×•×¨</button>
                </div>
            `;
        }

        function startCrosslateral() {
            let time = 30, step = 0;
            updateCrossMove(step);
            const timer = setInterval(() => {
                time--;
                const el = document.getElementById('crossTimer');
                if (el) el.textContent = time;
                if (time % 5 === 0 && time > 0) {
                    step = (step + 1) % crossMoves.length;
                    updateCrossMove(step);
                }
                if (time <= 0) {
                    clearInterval(timer);
                    completeExercise('sync', 5);
                    alert('×›×œ ×”×›×‘×•×“! ğŸ‰');
                    closeExercise();
                }
            }, 1000);
            activeTimers.push(timer);
        }

        function updateCrossMove(step) {
            const m = crossMoves[step];
            const l = document.getElementById('crossLeft');
            const r = document.getElementById('crossRight');
            const i = document.getElementById('crossInst');
            if (l) l.textContent = m.left;
            if (r) r.textContent = m.right;
            if (i) i.textContent = m.text;
        }

        // ===== EYE TRACKING =====
        function setupEyeTracking(title, area) {
            title.textContent = 'ğŸ‘ï¸ ××¢×§×‘ ×¢×™× ×™×™×';
            area.innerHTML = `
                <p style="text-align:center;margin-bottom:15px;color:var(--text-light)">×¢×§×•×‘ ××—×¨×™ ×”×›×“×•×¨ ×‘×¢×™× ×™×™× ×‘×œ×‘×“.</p>
                <div class="eye-tracking-area" id="trackingArea">
                    <div class="tracking-ball" id="trackingBall" style="top:50%;left:50%"></div>
                </div>
                <div class="timer-display" id="eyeTimer">30</div>
                <div class="timer-controls">
                    <button class="timer-btn primary" onclick="startEyeTracking()">×”×ª×—×œ</button>
                    <button class="timer-btn secondary" onclick="clearAllTimers()">×¢×¦×•×¨</button>
                </div>
            `;
        }

        function startEyeTracking() {
            let time = 30;
            moveBall();
            const moveTimer = setInterval(moveBall, 1500);
            const countTimer = setInterval(() => {
                time--;
                const el = document.getElementById('eyeTimer');
                if (el) el.textContent = time;
                if (time <= 0) {
                    clearInterval(moveTimer);
                    clearInterval(countTimer);
                    completeExercise('sync', 4);
                    alert('××¦×•×™×Ÿ! ğŸ‰');
                    closeExercise();
                }
            }, 1000);
            activeTimers.push(moveTimer, countTimer);
        }

        function moveBall() {
            const ball = document.getElementById('trackingBall');
            if (!ball) return;
            const positions = ['10%,10%','10%,80%','80%,10%','80%,80%','50%,50%','10%,50%','50%,10%','50%,80%','80%,50%'];
            const pos = positions[Math.floor(Math.random() * positions.length)].split(',');
            ball.style.top = pos[0];
            ball.style.left = pos[1];
        }

        // ===== BREATHING - FIXED WITH HOLD =====
        function setupBreathing(title, area) {
            title.textContent = 'ğŸŒ¬ï¸ × ×©×™××ª × ×—×™×¨×™×™× ×œ×¡×™×¨×•×’×™×Ÿ';
            breathRunning = false;
            breathPhase = 0;
            breathCycles = 0;
            
            area.innerHTML = `
                <p style="text-align:center;margin-bottom:15px;color:var(--text-light)">×¡×’×•×¨ ××ª ×”× ×—×™×¨ ×”××•××¨.<br>6 ×©× ×™×•×ª ×œ×›×œ ×©×œ×‘.</p>
                <div class="breathing-circle" id="breathCircle">
                    <span class="breathing-text" id="breathText">×œ×—×¥ ×”×ª×—×œ</span>
                </div>
                <div class="nostril-indicator">
                    <div class="nostril" id="leftNostril">ğŸ«<span class="nostril-label">×©×××œ</span></div>
                    <div class="nostril" id="rightNostril">ğŸ«<span class="nostril-label">×™××™×Ÿ</span></div>
                </div>
                <div class="timer-controls" style="margin-top:20px">
                    <button class="timer-btn primary" id="breathStartBtn" onclick="startBreathing()">×”×ª×—×œ</button>
                    <button class="timer-btn secondary" onclick="stopBreathing()">×¢×¦×•×¨</button>
                </div>
                <button class="start-btn" style="margin-top:15px" onclick="completeExercise('sync',6);closeExercise()">×¡×™×™××ª×™ âœ“</button>
            `;
        }

        function startBreathing() {
            if (breathRunning) return;
            breathRunning = true;
            breathPhase = 0;
            breathCycles = 0;
            
            const btn = document.getElementById('breathStartBtn');
            if (btn) { btn.textContent = '×¨×¥...'; btn.disabled = true; }
            
            runBreathPhase();
        }

        function runBreathPhase() {
            if (!breathRunning) return;
            
            const circle = document.getElementById('breathCircle');
            const text = document.getElementById('breathText');
            const leftN = document.getElementById('leftNostril');
            const rightN = document.getElementById('rightNostril');
            
            if (!circle || !text) {
                breathRunning = false;
                return;
            }
            
            // Remove all animation classes first
            circle.classList.remove('inhale', 'exhale', 'hold');
            if (leftN) leftN.classList.remove('active');
            if (rightN) rightN.classList.remove('active');
            
            switch(breathPhase) {
                case 0: // Inhale left
                    circle.classList.add('inhale');
                    text.textContent = '×©××£ ×©×××œ';
                    if (leftN) leftN.classList.add('active');
                    break;
                case 1: // Hold - NO ANIMATION
                    circle.classList.add('hold');
                    text.textContent = '×¢×¦×•×¨ × ×©×™××”';
                    // Keep circle still - no active nostril
                    break;
                case 2: // Exhale right
                    circle.classList.add('exhale');
                    text.textContent = '× ×©×•×£ ×™××™×Ÿ';
                    if (rightN) rightN.classList.add('active');
                    break;
                case 3: // Hold and count cycle - NO ANIMATION
                    circle.classList.add('hold');
                    text.textContent = '×¢×¦×•×¨ × ×©×™××”';
                    breathCycles++;
                    if (breathCycles >= 4) {
                        stopBreathing();
                        completeExercise('sync', 6);
                        alert('× ×¤×œ×! 4 ×¡×‘×‘×™×! ğŸŒ¬ï¸');
                        closeExercise();
                        return;
                    }
                    break;
            }
            
            breathPhase = (breathPhase + 1) % 4;
            
            const timer = setTimeout(runBreathPhase, 6000);
            activeTimers.push(timer);
        }

        function stopBreathing() {
            breathRunning = false;
            clearAllTimers();
            
            const circle = document.getElementById('breathCircle');
            const text = document.getElementById('breathText');
            const btn = document.getElementById('breathStartBtn');
            const leftN = document.getElementById('leftNostril');
            const rightN = document.getElementById('rightNostril');
            
            if (circle) {
                circle.classList.remove('inhale', 'exhale', 'hold');
                circle.style.transform = 'scale(1)';
                circle.style.background = 'var(--blue-soft)';
            }
            if (text) text.textContent = '×¢×¦×¨×ª';
            if (btn) { btn.textContent = '×”×ª×—×œ'; btn.disabled = false; }
            if (leftN) leftN.classList.remove('active');
            if (rightN) rightN.classList.remove('active');
        }

        // ===== MIRROR =====
        const mirrorMoves = [
            { text: '×”×¨× ×™×“×™×™× ×œ××¢×œ×”', emoji: 'ğŸ™Œ' },
            { text: '×”×•×¨×“ ×™×“×™×™× ×œ××˜×”', emoji: 'ğŸ‘' },
            { text: '×¤×ª×— ×œ×¦×“×“×™×', emoji: 'ğŸ¤²' },
            { text: '×¡×’×•×¨ ××’×¨×•×¤×™×', emoji: 'âœŠ' },
            { text: '×¤×ª×— ×›×¤×•×ª', emoji: 'ğŸ–ï¸' },
            { text: '×”× ×£ ×™×“×™×™×', emoji: 'ğŸ‘‹' }
        ];

        function setupMirror(title, area) {
            title.textContent = 'ğŸª ×ª× ×•×¢×•×ª ××¨××”';
            mirrorRunning = false;
            mirrorStep = 0;
            
            area.innerHTML = `
                <p style="text-align:center;margin-bottom:20px;color:var(--text-light)">×‘×¦×¢ ×ª× ×•×¢×•×ª ×¢× ×©×ª×™ ×”×™×“×™×™× ×‘×•-×–×× ×™×ª.</p>
                <div class="movement-visual">
                    <div class="body-part left-part" id="mirrorLeft">ğŸ–ï¸</div>
                    <div class="body-part right-part" id="mirrorRight">ğŸ–ï¸</div>
                </div>
                <div class="movement-instruction" id="mirrorInst">×œ×—×¥ ×”×ª×—×œ</div>
                <div class="timer-display" id="mirrorTimer">30</div>
                <div class="timer-controls">
                    <button class="timer-btn primary" id="mirrorStartBtn" onclick="startMirror()">×”×ª×—×œ</button>
                    <button class="timer-btn secondary" onclick="stopMirror()">×¢×¦×•×¨</button>
                </div>
                <button class="start-btn" style="margin-top:15px" onclick="completeExercise('sync',5);closeExercise()">×¡×™×™××ª×™ âœ“</button>
            `;
        }

        function startMirror() {
            if (mirrorRunning) return;
            mirrorRunning = true;
            mirrorStep = 0;
            let time = 30;
            
            const btn = document.getElementById('mirrorStartBtn');
            if (btn) { btn.textContent = '×¨×¥...'; btn.disabled = true; }
            
            updateMirrorMove();
            
            const timer = setInterval(() => {
                if (!mirrorRunning) {
                    clearInterval(timer);
                    return;
                }
                
                time--;
                const timerEl = document.getElementById('mirrorTimer');
                if (timerEl) timerEl.textContent = time;
                
                if (time % 5 === 0 && time > 0) {
                    mirrorStep = (mirrorStep + 1) % mirrorMoves.length;
                    updateMirrorMove();
                }
                
                if (time <= 0) {
                    clearInterval(timer);
                    mirrorRunning = false;
                    completeExercise('sync', 5);
                    alert('××¢×•×œ×”! ğŸª');
                    closeExercise();
                }
            }, 1000);
            activeTimers.push(timer);
        }

        function updateMirrorMove() {
            if (!mirrorRunning) return;
            const m = mirrorMoves[mirrorStep];
            const inst = document.getElementById('mirrorInst');
            const left = document.getElementById('mirrorLeft');
            const right = document.getElementById('mirrorRight');
            if (inst) inst.textContent = m.text;
            if (left) left.textContent = m.emoji;
            if (right) right.textContent = m.emoji;
        }

        function stopMirror() {
            mirrorRunning = false;
            clearAllTimers();
            const btn = document.getElementById('mirrorStartBtn');
            if (btn) { btn.textContent = '×”×ª×—×œ'; btn.disabled = false; }
        }

        // ===== DUAL WRITING =====
        const dualWords = ['×©×œ×•×','××”×‘×”','×©××©','×™×','×‘×™×ª','×¢×¥','×¤×¨×—','×›×•×›×‘','×œ×‘','×™×¨×—','×“×’','×¢×™×Ÿ','×™×“','×¨×’×œ','×©×™×¨','×—×œ×•×','××™×','××©','×¨×•×—','×©××™×','×—×’','×™×œ×“','×¡×¤×¨','×©×•×œ×—×Ÿ','×›×™×¡×','×“×œ×ª','×—×œ×•×Ÿ','×’×©×','×©×œ×’','××•×¨'];
        let wordIndex = 0;

        function setupDualWriting(title, area) {
            title.textContent = 'âœï¸ ×›×ª×™×‘×” ×“×•-×™×“× ×™×ª';
            area.innerHTML = `
                <p style="text-align:center;margin-bottom:20px;color:var(--text-light)">×§×— ×¢×˜ ×‘×›×œ ×™×“ ×•×›×ª×•×‘ ×‘×•-×–×× ×™×ª.</p>
                <div class="current-word" id="dualWord">${dualWords[0]}</div>
                <div class="timer-controls">
                    <button class="timer-btn primary" onclick="nextDualWord()">××™×œ×” ×”×‘××”</button>
                </div>
                <button class="tool-btn" style="margin-top:10px;width:100%" onclick="openWorksheet('dualwriting')">ğŸ“„ ×”×•×¨×“ ×“×£ ×¢×‘×•×“×”</button>
                <p style="text-align:center;margin-top:15px;color:var(--text-light);font-size:0.85rem">×˜×™×¤: ×”×ª×—×œ ×¢× ×¢×™×’×•×œ×™×</p>
                <button class="start-btn" style="margin-top:10px" onclick="completeExercise('sync',5);closeExercise()">×¡×™×™××ª×™ âœ“</button>
            `;
        }

        function nextDualWord() {
            wordIndex = (wordIndex + 1) % dualWords.length;
            const el = document.getElementById('dualWord');
            if (el) el.textContent = dualWords[wordIndex];
        }

        // ===== FIGURE 8 =====
        function setupFigure8(title, area) {
            title.textContent = 'âˆ ×¦×™×•×¨ 8 ×•-0 ×‘××•×•×™×¨';
            area.innerHTML = `
                <p style="text-align:center;margin-bottom:20px;color:var(--text-light)">8 ×‘×™×“ ×™××™×Ÿ, 0 ×‘×™×“ ×©×××œ - ×‘×•-×–×× ×™×ª!</p>
                <div class="figure-display">
                    <div class="figure-box">
                        <div class="dot-animate dot-8"></div>
                        <span class="figure-label">×™×“ ×™××™×Ÿ - 8</span>
                    </div>
                    <div class="figure-box">
                        <div class="dot-animate dot-0"></div>
                        <span class="figure-label">×™×“ ×©×××œ - 0</span>
                    </div>
                </div>
                <div class="timer-display" id="f8Timer">45</div>
                <div class="timer-controls">
                    <button class="timer-btn primary" id="f8StartBtn" onclick="startFigure8()">×”×ª×—×œ</button>
                    <button class="timer-btn secondary" onclick="clearAllTimers()">×¢×¦×•×¨</button>
                </div>
                <button class="tool-btn" style="margin-top:10px;width:100%" onclick="openWorksheet('figure8')">ğŸ“„ ×”×•×¨×“ ×“×£ ×¢×‘×•×“×”</button>
                <button class="start-btn" style="margin-top:10px" onclick="completeExercise('sync',7);closeExercise()">×¡×™×™××ª×™ âœ“</button>
            `;
        }

        function startFigure8() {
            let time = 45;
            const btn = document.getElementById('f8StartBtn');
            if (btn) { btn.textContent = '×¨×¥...'; btn.disabled = true; }
            
            const timer = setInterval(() => {
                time--;
                const el = document.getElementById('f8Timer');
                if (el) el.textContent = time;
                if (time <= 0) {
                    clearInterval(timer);
                    completeExercise('sync', 7);
                    alert('××“×”×™×! ğŸŒŸ');
                    closeExercise();
                }
            }, 1000);
            activeTimers.push(timer);
        }

        // ===== YOGA =====
        const yogaPoses = [
            { name: '×¢×¥ (Vrksasana)', desc: '×¢××•×“ ×¢×œ ×¨×’×œ ××—×ª, ×™×“×™×™× ××¢×œ ×”×¨××©.', emoji: 'ğŸŒ³', time: 20 },
            { name: '× ×©×¨ (Garudasana)', desc: '×¨×’×œ×™×™× ×•×™×“×™×™× ×›×¨×•×›×•×ª.', emoji: 'ğŸ¦…', time: 15 },
            { name: '×¤×¨×— ×”×œ×•×˜×•×¡', desc: '×¢××™×“×” ×¢×œ ×¨×’×œ ××—×ª, ×’×•×£ ×§×“×™××”.', emoji: 'ğŸŒ¸', time: 15 }
        ];

        function setupYoga(title, area) {
            title.textContent = 'ğŸ§˜ ×ª× ×•×—×•×ª ×™×•×’×” ×××–× ×•×ª';
            yogaIndex = 0;
            showYogaPose(area);
        }

        function showYogaPose(area) {
            const pose = yogaPoses[yogaIndex];
            area.innerHTML = `
                <div style="text-align:center">
                    <div style="font-size:4rem;margin-bottom:15px">${pose.emoji}</div>
                    <h3 style="margin-bottom:10px">${pose.name}</h3>
                    <p style="color:var(--text-light);margin-bottom:20px">${pose.desc}</p>
                    <div class="timer-display" id="yogaTimer">${pose.time}</div>
                    <div class="timer-controls">
                        <button class="timer-btn primary" onclick="startYogaPose(${pose.time})">×”×ª×—×œ</button>
                        <button class="timer-btn secondary" onclick="skipYogaPose()">×“×œ×’</button>
                    </div>
                </div>
            `;
        }

        function startYogaPose(seconds) {
            let time = seconds;
            const timer = setInterval(() => {
                time--;
                const el = document.getElementById('yogaTimer');
                if (el) el.textContent = time;
                if (time <= 0) {
                    clearInterval(timer);
                    yogaIndex++;
                    if (yogaIndex >= yogaPoses.length) {
                        completeExercise('sync', 6);
                        alert('××“×”×™×! ğŸ§˜');
                        closeExercise();
                    } else {
                        showYogaPose(document.getElementById('exerciseArea'));
                    }
                }
            }, 1000);
            activeTimers.push(timer);
        }

        function skipYogaPose() {
            clearAllTimers();
            yogaIndex++;
            if (yogaIndex >= yogaPoses.length) {
                completeExercise('sync', 4);
                closeExercise();
            } else {
                showYogaPose(document.getElementById('exerciseArea'));
            }
        }

        // ===== COUNTING =====
        function setupCounting(title, area) {
            title.textContent = 'ğŸ”¢ ×¡×¤×™×¨×” ×•×"×‘ ×‘×•-×–×× ×™×ª';
            area.innerHTML = `
                <p style="text-align:center;margin-bottom:20px;color:var(--text-light)">×¡×¤×•×¨ ×‘×§×•×œ 1-20 ×‘×–××Ÿ ×©××ª ×›×•×ª×‘×ª ×-×ª!</p>
                <div class="current-word" style="font-size:1.5rem">×¤×”: 1, 2, 3...<br>×™×“: ×, ×‘, ×’...</div>
                <div class="timer-display" id="cntTimer">60</div>
                <div class="timer-controls">
                    <button class="timer-btn primary" id="cntStartBtn" onclick="startCounting()">×”×ª×—×œ</button>
                    <button class="timer-btn secondary" onclick="clearAllTimers()">×¢×¦×•×¨</button>
                </div>
                <button class="tool-btn" style="margin-top:10px;width:100%" onclick="openWorksheet('counting')">ğŸ“„ ×”×•×¨×“ ×“×£ ×¢×‘×•×“×”</button>
                <button class="start-btn" style="margin-top:10px" onclick="completeExercise('sync',6);closeExercise()">×¡×™×™××ª×™ âœ“</button>
            `;
        }

        function startCounting() {
            let time = 60;
            const btn = document.getElementById('cntStartBtn');
            if (btn) { btn.textContent = '×¨×¥...'; btn.disabled = true; }
            
            const timer = setInterval(() => {
                time--;
                const el = document.getElementById('cntTimer');
                if (el) el.textContent = time;
                if (time <= 0) {
                    clearInterval(timer);
                    completeExercise('sync', 6);
                    alert('××¢×•×œ×”! ğŸ§ ');
                    closeExercise();
                }
            }, 1000);
            activeTimers.push(timer);
        }

        // ===== WORKSHEETS =====
        function openWorksheet(type) {
            var worksheetHTML = getWorksheetHTML(type);
            var blob = new Blob([worksheetHTML], {type: 'text/html;charset=utf-8'});
            var url = URL.createObjectURL(blob);
            var a = document.createElement('a');
            a.href = url;
            a.download = 'worksheet-' + type + '.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        function getWorksheetHTML(type) {
            var baseStyle = `
                @import url('https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700&family=Rubik:wght@400;500;600&display=swap');
                * { margin: 0; padding: 0; box-sizing: border-box; }
                body { font-family: 'Heebo', sans-serif; background: #FFF; color: #4A3F55; padding: 40px; direction: rtl; }
                .worksheet { max-width: 800px; margin: 0 auto; }
                .header { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 3px solid #FFB6C8; }
                .header h1 { font-family: 'Rubik', sans-serif; font-size: 2rem; color: #4A3F55; margin-bottom: 10px; }
                .header p { color: #7A6B85; font-size: 1rem; }
                .date-line { text-align: left; margin-bottom: 20px; color: #7A6B85; }
                .instructions { background: #FFE8F0; padding: 15px 20px; border-radius: 15px; margin-bottom: 25px; }
                .instructions h3 { color: #D4A574; margin-bottom: 8px; }
                .draw-box { border: 3px solid #FFB6C8; border-radius: 20px; height: 300px; margin-bottom: 20px; background: linear-gradient(to bottom, #FFF8F0 0%, #FFF 100%); position: relative; }
                .draw-box::before { content: 'âœï¸'; position: absolute; top: 10px; right: 10px; font-size: 1.5rem; opacity: 0.3; }
                .dual-container { display: flex; gap: 20px; margin-bottom: 20px; }
                .dual-box { flex: 1; border: 3px solid #DCD0FF; border-radius: 20px; padding: 15px; min-height: 350px; }
                .dual-box.left { border-color: #C8E0FF; }
                .dual-box.right { border-color: #DCD0FF; }
                .dual-box h4 { text-align: center; color: #7A6B85; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px dashed #E8C9A8; }
                .lines { display: flex; flex-direction: column; gap: 25px; }
                .line { border-bottom: 2px solid #F5EDE5; height: 30px; }
                .word-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 25px; }
                .word-box { border: 2px solid #E8C9A8; border-radius: 12px; padding: 15px 10px; text-align: center; background: #FFF8F0; }
                .word-box .word { font-family: 'Rubik', sans-serif; font-size: 1.3rem; color: #D4A574; margin-bottom: 10px; }
                .word-box .write-space { border-bottom: 2px solid #FFB6C8; height: 25px; }
                .alef-bet-grid { display: grid; grid-template-columns: repeat(11, 1fr); gap: 8px; margin-bottom: 25px; }
                .letter-box { border: 2px solid #DCD0FF; border-radius: 10px; padding: 8px; text-align: center; }
                .letter-box .letter { font-size: 1.5rem; color: #B8956A; }
                .letter-box .write-line { border-bottom: 2px solid #FFB6C8; height: 25px; margin-top: 5px; }
                .listen-section { margin-bottom: 20px; }
                .listen-row { display: flex; align-items: center; gap: 15px; margin-bottom: 15px; padding: 15px; background: #FFF8F0; border-radius: 12px; }
                .listen-num { width: 35px; height: 35px; background: #D4A574; color: #FFF; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; }
                .listen-input { flex: 1; border-bottom: 2px solid #E8C9A8; height: 30px; }
                .emoji-row { text-align: center; font-size: 2rem; margin: 20px 0; letter-spacing: 10px; opacity: 0.3; }
                .reflection-box { border: 3px solid #E8C9A8; border-radius: 20px; padding: 20px; min-height: 200px; background: #FFF8F0; }
                .reflection-box h4 { color: #D4A574; margin-bottom: 15px; }
                .assoc-center { text-align: center; margin: 30px 0; }
                .assoc-word { font-family: 'Rubik', sans-serif; font-size: 3rem; color: #D4A574; padding: 20px 40px; background: #FFE8F0; border-radius: 20px; display: inline-block; }
                .assoc-bubbles { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; margin-top: 30px; }
                .bubble { width: 120px; height: 60px; border: 3px solid #DCD0FF; border-radius: 30px; }
                .print-btn { position: fixed; top: 20px; left: 20px; padding: 12px 25px; background: #D4A574; color: #FFF; border: none; border-radius: 25px; font-family: 'Heebo', sans-serif; font-size: 1rem; cursor: pointer; }
                .print-btn:hover { background: #B8956A; }
                @media print { .print-btn { display: none; } }
                .footer { text-align: center; margin-top: 30px; padding-top: 20px; border-top: 2px solid #FFE8F0; color: #7A6B85; font-size: 0.85rem; }
                .decor { text-align: center; margin: 15px 0; font-size: 1.5rem; opacity: 0.4; }
            `;
            
            var content = '';
            var title = '';
            var instructions = '';
            
            switch(type) {
                case 'drawing':
                    title = 'âœï¸ ×“×£ ×¦×™×•×¨ - ×™×“ ×œ× ×“×•××™× × ×˜×™×ª';
                    instructions = '×¦×™×™×¨ ×¢× ×”×™×“ ×”×œ× ×“×•××™× × ×˜×™×ª ×©×œ×š. ××œ ×ª×“××’ ××”×ª×•×¦××” - ×”×ª×”×œ×™×š ×”×•× ×”×—×©×•×‘!';
                    content = `
                        <div class="decor">ğŸ¨ âœ¨ ğŸ–Œï¸ âœ¨ ğŸ¨</div>
                        <div class="draw-box"></div>
                        <div class="decor">ğŸŒ¸ ğŸŒº ğŸŒ¸</div>
                        <div class="draw-box"></div>
                        <div class="reflection-box">
                            <h4>ğŸ’­ ××™×š ×”×¨×’×©×ª ×‘×–××Ÿ ×”×¦×™×•×¨?</h4>
                            <div class="lines">
                                <div class="line"></div>
                                <div class="line"></div>
                                <div class="line"></div>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'dualwriting':
                    title = 'âœï¸ ×“×£ ×›×ª×™×‘×” ×“×•-×™×“× ×™×ª';
                    instructions = '×›×ª×•×‘ ××ª ××•×ª×” ××™×œ×” ×‘×©×ª×™ ×”×™×“×™×™× ×‘×•-×–×× ×™×ª. ×”×ª×—×œ ×¢× ×¦×•×¨×•×ª ×¤×©×•×˜×•×ª (×¢×™×’×•×œ×™×, ×§×•×•×™×) ×•××– ×”×ª×§×“× ×œ××™×œ×™×.';
                    content = `
                        <div class="decor">âœ¨ ğŸ™Œ âœ¨</div>
                        <div class="word-grid">
                            <div class="word-box"><div class="word">×©×œ×•×</div><div class="write-space"></div></div>
                            <div class="word-box"><div class="word">××”×‘×”</div><div class="write-space"></div></div>
                            <div class="word-box"><div class="word">×©××©</div><div class="write-space"></div></div>
                            <div class="word-box"><div class="word">×™×</div><div class="write-space"></div></div>
                            <div class="word-box"><div class="word">×‘×™×ª</div><div class="write-space"></div></div>
                            <div class="word-box"><div class="word">×¢×¥</div><div class="write-space"></div></div>
                            <div class="word-box"><div class="word">×¤×¨×—</div><div class="write-space"></div></div>
                            <div class="word-box"><div class="word">×œ×‘</div><div class="write-space"></div></div>
                        </div>
                        <div class="dual-container">
                            <div class="dual-box right">
                                <h4>ğŸ–ï¸ ×™×“ ×™××™×Ÿ</h4>
                                <div class="lines">
                                    <div class="line"></div>
                                    <div class="line"></div>
                                    <div class="line"></div>
                                    <div class="line"></div>
                                    <div class="line"></div>
                                    <div class="line"></div>
                                </div>
                            </div>
                            <div class="dual-box left">
                                <h4>ğŸ¤š ×™×“ ×©×××œ</h4>
                                <div class="lines">
                                    <div class="line"></div>
                                    <div class="line"></div>
                                    <div class="line"></div>
                                    <div class="line"></div>
                                    <div class="line"></div>
                                    <div class="line"></div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'counting':
                    title = 'ğŸ”¢ ×“×£ ×¡×¤×™×¨×” ×•×"×‘ ×‘×•-×–×× ×™×ª';
                    instructions = '×¡×¤×•×¨ ×‘×§×•×œ ×¨× 1-22 ×‘×–××Ÿ ×©××ª×” ×›×•×ª×‘ ××ª ×”××•×ª×™×•×ª ×-×ª. ×”××•×— ×¢×•×‘×“ ×¢×œ ×©× ×™ ×¢×¨×•×¦×™× ×‘××§×‘×™×œ!';
                    content = `
                        <div class="decor">ğŸ§  âœ¨ ğŸ”¤ âœ¨ ğŸ§ </div>
                        <div class="alef-bet-grid">
                            <div class="letter-box"><div class="letter">×</div><div class="write-line"></div></div>
                            <div class="letter-box"><div class="letter">×‘</div><div class="write-line"></div></div>
                            <div class="letter-box"><div class="letter">×’</div><div class="write-line"></div></div>
                            <div class="letter-box"><div class="letter">×“</div><div class="write-line"></div></div>
                            <div class="letter-box"><div class="letter">×”</div><div class="write-line"></div></div>
                            <div class="letter-box"><div class="letter">×•</div><div class="write-line"></div></div>
                            <div class="letter-box"><div class="letter">×–</div><div class="write-line"></div></div>
                            <div class="letter-box"><div class="letter">×—</div><div class="write-line"></div></div>
                            <div class="letter-box"><div class="letter">×˜</div><div class="write-line"></div></div>
                            <div class="letter-box"><div class="letter">×™</div><div class="write-line"></div></div>
                            <div class="letter-box"><div class="letter">×›</div><div class="write-line"></div></div>
                            <div class="letter-box"><div class="letter">×œ</div><div class="write-line"></div></div>
                            <div class="letter-box"><div class="letter">×</div><div class="write-line"></div></div>
                            <div class="letter-box"><div class="letter">× </div><div class="write-line"></div></div>
                            <div class="letter-box"><div class="letter">×¡</div><div class="write-line"></div></div>
                            <div class="letter-box"><div class="letter">×¢</div><div class="write-line"></div></div>
                            <div class="letter-box"><div class="letter">×¤</div><div class="write-line"></div></div>
                            <div class="letter-box"><div class="letter">×¦</div><div class="write-line"></div></div>
                            <div class="letter-box"><div class="letter">×§</div><div class="write-line"></div></div>
                            <div class="letter-box"><div class="letter">×¨</div><div class="write-line"></div></div>
                            <div class="letter-box"><div class="letter">×©</div><div class="write-line"></div></div>
                            <div class="letter-box"><div class="letter">×ª</div><div class="write-line"></div></div>
                        </div>
                        <div class="reflection-box">
                            <h4>ğŸ’­ ×¨×©×•× ××ª ×”×—×•×•×™×” ×©×œ×š:</h4>
                            <div class="lines">
                                <div class="line"></div>
                                <div class="line"></div>
                                <div class="line"></div>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'listening':
                    title = 'ğŸµ ×“×£ ×”×§×©×‘×” ××•×“×¢×ª';
                    instructions = '×¢×¦×•× ×¢×™× ×™×™× ×•×”×§×©×‘ ×œ×¡×‘×™×‘×” ×‘××©×š 2 ×“×§×•×ª. ×¨×©×•× ×›×œ ×¦×œ×™×œ ×©×©××¢×ª.';
                    content = `
                        <div class="decor">ğŸ‘‚ ğŸ¶ ğŸµ ğŸ¶ ğŸ‘‚</div>
                        <div class="listen-section">
                            <div class="listen-row"><div class="listen-num">1</div><div class="listen-input"></div></div>
                            <div class="listen-row"><div class="listen-num">2</div><div class="listen-input"></div></div>
                            <div class="listen-row"><div class="listen-num">3</div><div class="listen-input"></div></div>
                            <div class="listen-row"><div class="listen-num">4</div><div class="listen-input"></div></div>
                            <div class="listen-row"><div class="listen-num">5</div><div class="listen-input"></div></div>
                            <div class="listen-row"><div class="listen-num">6</div><div class="listen-input"></div></div>
                            <div class="listen-row"><div class="listen-num">7</div><div class="listen-input"></div></div>
                            <div class="listen-row"><div class="listen-num">8</div><div class="listen-input"></div></div>
                            <div class="listen-row"><div class="listen-num">9</div><div class="listen-input"></div></div>
                            <div class="listen-row"><div class="listen-num">10</div><div class="listen-input"></div></div>
                        </div>
                        <div class="reflection-box">
                            <h4>ğŸ’­ ××™×–×” ×¦×œ×™×œ ×”×¤×ª×™×¢ ××•×ª×š?</h4>
                            <div class="lines">
                                <div class="line"></div>
                                <div class="line"></div>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'imagination':
                    title = 'ğŸ­ ×“×£ ×“××™×•×Ÿ ××•×“×¨×š';
                    instructions = '×¡×’×•×¨ ×¢×™× ×™×™×, ×“××™×™×Ÿ ××ª ×”×¡×¦× ×”, ×•××– ×ª××¨ ××” ×¨××™×ª ×‘×¤×™×¨×•×˜.';
                    content = `
                        <div class="decor">ğŸŒ… ğŸŒŠ ğŸŒ¸ ğŸŒ³ â­</div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 25px;">
                            <div class="reflection-box">
                                <h4>ğŸ–ï¸ ×—×•×£ ×™× ×‘×©×§×™×¢×”</h4>
                                <div class="lines">
                                    <div class="line"></div>
                                    <div class="line"></div>
                                    <div class="line"></div>
                                    <div class="line"></div>
                                </div>
                            </div>
                            <div class="reflection-box">
                                <h4>ğŸŒ² ×™×¢×¨ ×™×¨×•×§ ×¢× × ×—×œ</h4>
                                <div class="lines">
                                    <div class="line"></div>
                                    <div class="line"></div>
                                    <div class="line"></div>
                                    <div class="line"></div>
                                </div>
                            </div>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div class="reflection-box">
                                <h4>ğŸŒ¸ ×’×Ÿ ×¤×¨×—×™× ×‘××‘×™×‘</h4>
                                <div class="lines">
                                    <div class="line"></div>
                                    <div class="line"></div>
                                    <div class="line"></div>
                                    <div class="line"></div>
                                </div>
                            </div>
                            <div class="reflection-box">
                                <h4>â­ ×©××™×™× ××œ××™ ×›×•×›×‘×™×</h4>
                                <div class="lines">
                                    <div class="line"></div>
                                    <div class="line"></div>
                                    <div class="line"></div>
                                    <div class="line"></div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'association':
                    title = 'ğŸ’­ ×“×£ ××¡×•×¦×™××¦×™×•×ª ×—×•×¤×©×™×•×ª';
                    instructions = '×›×ª×•×‘ ×›×œ ××” ×©×¢×•×œ×” ×œ×š ×œ×¨××© ×›×©××ª×” ×¨×•××” ××ª ×”××™×œ×” ×‘××¨×›×–. ××™×Ÿ ×ª×©×•×‘×•×ª × ×›×•× ×•×ª ××• ×œ× × ×›×•× ×•×ª!';
                    content = `
                        <div class="assoc-center">
                            <div class="assoc-word">×©××© â˜€ï¸</div>
                        </div>
                        <div class="assoc-bubbles">
                            <div class="bubble"></div>
                            <div class="bubble"></div>
                            <div class="bubble"></div>
                            <div class="bubble"></div>
                            <div class="bubble"></div>
                            <div class="bubble"></div>
                            <div class="bubble"></div>
                            <div class="bubble"></div>
                        </div>
                        <div class="decor">ğŸŒ¸ ğŸŒº ğŸŒ¸</div>
                        <div class="assoc-center">
                            <div class="assoc-word">××™× ğŸ’§</div>
                        </div>
                        <div class="assoc-bubbles">
                            <div class="bubble"></div>
                            <div class="bubble"></div>
                            <div class="bubble"></div>
                            <div class="bubble"></div>
                            <div class="bubble"></div>
                            <div class="bubble"></div>
                            <div class="bubble"></div>
                            <div class="bubble"></div>
                        </div>
                    `;
                    break;
                    
                case 'figure8':
                    title = 'âˆ ×“×£ ×ª×¨×’×•×œ 8 ×•-0 ×‘××•×•×™×¨';
                    instructions = '×¦×™×™×¨ 8 ×¢× ×™×“ ×™××™×Ÿ ×•-0 ×¢× ×™×“ ×©×××œ ×‘×•-×–×× ×™×ª. ×ª×¨×’×œ ×§×•×“× ×¢×œ ×”× ×™×™×¨!';
                    content = `
                        <div class="decor">âœ¨ âˆ âœ¨</div>
                        <div class="dual-container">
                            <div class="dual-box right">
                                <h4>ğŸ–ï¸ ×™×“ ×™××™×Ÿ - ×¦×™×™×¨ 8</h4>
                                <div style="height: 250px; border: 2px dashed #E8C9A8; border-radius: 15px; display: flex; align-items: center; justify-content: center;">
                                    <span style="font-size: 8rem; color: #F5EDE5;">8</span>
                                </div>
                            </div>
                            <div class="dual-box left">
                                <h4>ğŸ¤š ×™×“ ×©×××œ - ×¦×™×™×¨ 0</h4>
                                <div style="height: 250px; border: 2px dashed #E8C9A8; border-radius: 15px; display: flex; align-items: center; justify-content: center;">
                                    <span style="font-size: 8rem; color: #F5EDE5;">0</span>
                                </div>
                            </div>
                        </div>
                        <div class="decor">ğŸŒŸ ×¢×›×©×™×• × ×¡×” ×‘×•-×–×× ×™×ª! ğŸŒŸ</div>
                        <div class="draw-box" style="height: 200px;"></div>
                    `;
                    break;
            }
            
            return `<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>${title}</title>
    <style>${baseStyle}</style>
</head>
<body>
    <button class="print-btn" onclick="window.print()">ğŸ–¨ï¸ ×”×“×¤×¡</button>
    <div class="worksheet">
        <div class="header">
            <h1>${title}</h1>
            <p>××™××•×Ÿ ×”××•×— ×”×™×× ×™ ×•×¡×™× ×›×¨×•×Ÿ ×”×”××™×¡×¤×¨×•×ª</p>
        </div>
        <div class="date-line">×ª××¨×™×š: ________________</div>
        <div class="instructions">
            <h3>ğŸ“ ×”×•×¨××•×ª:</h3>
            <p>${instructions}</p>
        </div>
        ${content}
        <div class="footer">ğŸ§  ×”××©×š ×œ×”×ª×××Ÿ ×›×œ ×™×•× - ×”××•×— ×©×œ×š ×™×•×“×” ×œ×š! ğŸ§ </div>
    </div>
</body>
</html>`;
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', loadState);
    </script>
</body>
</html>
